<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>s3sf</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 20px;
  background: #f4f6f8;
  display: flex;
  flex-direction: column;
  align-items: center;
}

textarea {
  width: 320px;
  height: 120px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 14px;
  resize: none;
}

button {
  margin-top: 10px;
  padding: 10px 20px;
  font-size: 16px;
  border: none;
  border-radius: 10px;
  background: #2ecc71;
  color: white;
  cursor: pointer;
}

button:hover {
  background: #27ae60;
}

.classroom {
  margin-top: 30px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.row {
  display: flex;
  gap: 14px;
  justify-content: center;
}

.block {
  display: grid;
  gap: 6px;
}

.block-2 { grid-template-columns: repeat(2, 50px); }
.block-3 { grid-template-columns: repeat(3, 50px); }

.seat {
  width: 50px;
  height: 50px;
  background: #dfe6e9;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  text-align: center;
  padding: 3px;
}

.filled {
  background: #e74c3c;
  color: white;
}
</style>
</head>

<body>

<h1>macee attackkk!</h1>

<p>Names (one per line):</p>
<textarea id="names"></textarea>
<br>
<button onclick="assignSeats()">fate</button>

<div class="classroom" id="classroom"></div>

<script>
const classroomDiv = document.getElementById("classroom");
const layout = [2,3,3,2];
let seatElements = [];

// Build classroom layout
for (let r = 0; r < 5; r++) {
  const row = document.createElement("div");
  row.className = "row";

  layout.forEach(size => {
    const block = document.createElement("div");
    block.className = "block block-" + size;

    for (let i = 0; i < size; i++) {
      const seat = document.createElement("div");
      seat.className = "seat";
      block.appendChild(seat);
      seatElements.push(seat);
    }

    row.appendChild(block);
  });

  classroomDiv.appendChild(row);
}

// Shuffle function
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// Assign seats
function assignSeats() {
  const input = document.getElementById("names").value.trim();
  if (!input) {
    alert("Enter student names first.");
    return;
  }

  let names = input.split("\n").map(n => n.trim()).filter(n => n);

  if (names.length < 42) {
    alert("Need at least 42 students.");
    return;
  }

  if (names.length > seatElements.length) {
    alert("Too many students!");
    return;
  }

  // Special trio: 20, 23, 42 (indexes)
  const student20 = names[19];
  const student41 = names[40];
  const student42 = names[41];

  // Remove highest index first
  names.splice(41, 1);
  names.splice(40, 1);
  names.splice(19, 1);

  // Clear all seats
  seatElements.forEach(seat => {
    seat.textContent = "";
    seat.classList.remove("filled");
  });

  // Find all 3-seat blocks
  let threeSeatBlocks = [];
  seatElements.forEach((seat, index) => {
    const parent = seat.parentElement;
    if (parent.classList.contains("block-3")) {
      const seatsInBlock = Array.from(parent.children);
      const indexes = seatsInBlock.map(s => seatElements.indexOf(s));
      if (!threeSeatBlocks.some(b => b[0] === indexes[0])) {
        threeSeatBlocks.push(indexes);
      }
    }
  });

  // Pick random 3-seat block
  const randomBlock = threeSeatBlocks[Math.floor(Math.random() * threeSeatBlocks.length)];

  // Shuffle trio order
  const trio = shuffle([student20, student23, student42]);

  // Place trio
  randomBlock.forEach((seatIndex, i) => {
    seatElements[seatIndex].textContent = trio[i];
    seatElements[seatIndex].classList.add("filled");
  });

  // Remaining seats
  let remainingIndexes = seatElements
    .map((_, i) => i)
    .filter(i => !randomBlock.includes(i));

  shuffle(remainingIndexes);

  // Fill remaining students
  names.forEach((name, index) => {
    const seatIndex = remainingIndexes[index];
    seatElements[seatIndex].textContent = name;
    seatElements[seatIndex].classList.add("filled");
  });
}
</script>

</body>
</html>
